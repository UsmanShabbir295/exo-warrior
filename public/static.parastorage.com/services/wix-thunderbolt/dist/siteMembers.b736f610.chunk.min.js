(self.webpackJsonp__wix_thunderbolt_app=self.webpackJsonp__wix_thunderbolt_app||[]).push([[4522],{10124:function(e,t,o){"use strict";o.r(t),o.d(t,{AUTH_RESULT_REASON:function(){return C.$9},BIEvents:function(){return k},INTERACTIONS:function(){return C.SE},PrivacyStatus:function(){return C.iY},SiteMembersApiSymbol:function(){return y.n9},isLoginAcceptableError:function(){return f.Y2},isSignupAcceptableError:function(){return f.fJ},memberDetailsFromDTO:function(){return f.Ky},page:function(){return q},site:function(){return j}});var i=o(56510),s=o(25259),a=o(14439),n=o(21980),r=o(55437),l=o(32114),c=o(53891),u=o(54164),g=o(2922),d=o(24888),m=o(52192),p=o(31619),h=o(75471),b=o(51978),w=o(19378),S=o(51968),v=o(18037),C=o(6504),D=o(63805),y=o(50997);class P{constructor(e,t,o,i){this.propsStore=e,this.structureApi=t,this.siteScrollBlocker=o,this.browserWindow=i}async displayDialog(e,t,o,i={}){const s=async()=>{(0,m.yF)(this.browserWindow)||(this.activeElementBeforeShowDialog=this.browserWindow.document.activeElement);const i=(0,v.uniqueId)(y.rj);this.propsStore.update({[i]:Object.assign(Object.assign({},t),o)}),(0,D.U)(),await this.structureApi.addComponentToDynamicStructure(i,{componentType:e,components:[]}),this.currentCompId&&(this.structureApi.removeComponentFromDynamicStructure(this.currentCompId),this.siteScrollBlocker.setSiteScrollingBlocked(!1,this.currentCompId)),this.siteScrollBlocker.setSiteScrollingBlocked(!0,i),this.currentCompId=i},{shouldWaitForAppDidMount:a,registerToAppDidMount:n}=i;a&&n?n(s):await s()}hideDialog(){var e;this.currentCompId&&(this.structureApi.removeComponentFromDynamicStructure(this.currentCompId),this.siteScrollBlocker.setSiteScrollingBlocked(!1,this.currentCompId),(0,D.i)()),this.currentCompId=void 0,(0,m.yF)(this.browserWindow)||(null===(e=this.activeElementBeforeShowDialog)||void 0===e||e.focus(),this.activeElementBeforeShowDialog=null)}}var f=o(13039),E=o(56334);const k=({sessionManager:e,businessLogger:t,wixBiSession:o,viewMode:i,language:s})=>{const a=(t,a)=>({biToken:o.msId,context:t,ts:T(o),viewmode:i,visitor_id:e.getVisitorId(),site_member_id:e.getSiteMemberId(),vsi:o.viewerSessionId,site_settings_lng:s.siteLanguage,browser_lng:s.userLanguage,lng_mismatch:s.siteLanguage!==s.userLanguage,layout:a});return{loginOrSignUpDialogLoaded:(e,o="fullscreen")=>{t.logger.log(Object.assign({src:5,evid:658},a(e,o)),{endpoint:"site-members"})},closingDialog:(e,o="fullscreen")=>{t.logger.log(Object.assign({src:5,evid:602,form_type:"default"},a(e,o)),{endpoint:"site-members"})},emailAuthSubmitClicked:(e,o)=>{t.logger.log(Object.assign({src:5,evid:603,form_type:"default"},a(e,o)),{endpoint:"site-members"})},siteMembersFeatureLoaded:()=>{t.logger.log(Object.assign({src:5,evid:698},a()),{endpoint:"site-members"})},siteMembersSdkFeatureLoaded:()=>{t.logger.log(Object.assign({src:5,evid:699},a()),{endpoint:"site-members"})}}},T=e=>{const t=e.initialTimestamp||0;return Date.now()-t},A={isCloseable:!0,returnPages:!1};class L{constructor(e){this.shouldRunCustomPopupCloseCallback=!0,this.popups=e,this.config=A}async openPopupPage(e,t){var o;const i=this.shouldRunCustomPopupCloseCallback;this.shouldRunCustomPopupCloseCallback=!1,await(null===(o=this.popups)||void 0===o?void 0:o.openPopupPage(e,(()=>{this.shouldRunCustomPopupCloseCallback&&(this.rejectAuthenticationRequest(),t&&t())}))),this.shouldRunCustomPopupCloseCallback=i}preventCustomPopupCloseCallback(){this.shouldRunCustomPopupCloseCallback=!1}allowCustomPopupCloseCallback(){this.shouldRunCustomPopupCloseCallback=!0}assignRequestAuthenticationRejection(e){this.requestAuthenticationRejectInstance=this.requestAuthenticationRejectInstance||e}assignRequestAuthenticationResolveInstance(e){this.requestAuthenticationResolveInstance=this.requestAuthenticationResolveInstance||e}assignRequestAuthenticationPromise(e,t){this.requestAuthenticationRejectInstance=this.requestAuthenticationRejectInstance||t,this.requestAuthenticationResolveInstance=this.requestAuthenticationResolveInstance||e}rejectAuthenticationRequest(){this.requestAuthenticationRejectInstance&&(this.requestAuthenticationRejectInstance(C.$9.CANCELED),this.reset())}resolveAuthenticationRequest(e){this.requestAuthenticationRejectInstance&&(this.requestAuthenticationResolveInstance(e),this.reset())}setConfig({isCloseable:e=!0,returnPages:t=!1}){this.config={isCloseable:e,returnPages:t}}reset(){this.requestAuthenticationRejectInstance=void 0,this.requestAuthenticationResolveInstance=void 0,this.config=A}}const I=(e,t,o)=>{document.cookie=`${e}=;max-age=0`,document.cookie=`${e}=;max-age=0;path=${t}`,document.cookie=`${e}=;domain=${o};max-age=0`,document.cookie=`${e}=;domain=${o};max-age=0;path=${t}`},R=(0,i.ff)([(0,i.t6)(s.R9,y.u2),(0,i.t6)(s.jC,y.u2),(0,i.t6)(s.Wf,y.u2),a.U,n.EE,n.Zr,p.X,r.xP,r.QZ,n.bk,n.ZQ,h.F0,b.x,l.v,h.Iz,c.$,u.s,(0,i.jt)(w.r_),(0,i.jt)(S.I),g.jj,d.O,(0,i.jt)(E.I)],((e,t,o,i,s,a,n,r,l,c,u,g,d,p,h,b,w,S,D={trackEvent:()=>0},y,E,T)=>{var A;const{collectionExposure:R,smcollectionId:O,smSessionCookie:_,protectedHomepage:M,isCommunityInstalled:N,memberInfoAppId:U,isTemplate:$}=e;let{sm_efCookie:j}=e;const q="WixInternal"===R,F=n.getUserSession(),B=n.getAppInstanceByAppDefId("22bef345-3c5b-4c18-b782-74d4085112ff"),W=()=>(0,f.OP)(n),{smSettings:x,tpaApplicationIds:G,policyLinks:V}=t,K=U&&G[U],{siteRevision:Y,metaSiteId:z,siteId:H,externalBaseUrl:J}=a.site,X=a.requestUrl,Q=a.viewMode,Z=-1!==C.F0.findIndex((e=>{var t,o;return null===(o=null===(t=null==u?void 0:u.navigator)||void 0===t?void 0:t.userAgent)||void 0===o?void 0:o.includes(e)})),ee=!Z,te=!Z,oe=`/_api/wix-sm-webapp/tokens/verify/${z}/${H}`,ie=`${J.replace(/\/$/,"")}/api/wix-sm/v1/authorize/${H}/pages`,se=`/_api/wix-sm-webapp/tokens/logout/${z}`,ae=`/_api/wix-sm-webapp/member/changePasswordWithMailToken?metaSiteId=${z}&collectionId=${O}`,ne=`/_api/wix-sm-webapp/social/token/handle?metaSiteId=${z}&collectionId=${O}`,re=x.smFirstDialogLogin?"login":"signup",{socialLoginFacebookEnabled:le,socialLoginGoogleEnabled:ce,termsOfUse:ue,privacyPolicy:ge,codeOfConduct:de,customSignUpPageId:me,customSignInPageId:pe}=x,he=null===(A=x.joinCommunityCheckedByDefault)||void 0===A||A;let{smToken:be}=e,we={},Se=_,ve=null,Ce=!1;const De=e=>{ve=e},ye=()=>({registerToAppDidMount:De,shouldWaitForAppDidMount:!Ce}),Pe={},fe={},Ee=k({sessionManager:n,businessLogger:b,wixBiSession:w,viewMode:null==Q?void 0:Q.toUpperCase(),language:c});Ee.siteMembersFeatureLoaded();const ke={},Te=(0,f.Qn)(i,{credentials:"same-origin",headers:{accept:"application/json","x-wix-site-revision":`${Y}`,"x-wix-client-artifact-id":"thunderbolt"}},a.requestUrl),Ae=((e,t,o,i)=>new P(e,t,o,i))(r,l,d,u),Le=new L(S),Ie=null==T?void 0:T.getBsi(),Re=Ie?Ie.split("|")[0]:"00000000-0000-0000-0000-000000000000",Oe={appDidMount(){ve&&ve(),Ce=!0},async login(e,t,o,i=!1){D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:"Wix"}});try{const s=await Oe.performLogin(e,t,o),a=await Oe.handleLoginResponse(s,i);return D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:"Wix"}}),a}catch(e){throw D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Failure",eventLabel:"Wix"}}),e}},async performLogin(e,t,o){var i;const s=await Te("/_api/wix-sm-webapp/v1/auth/login",{method:"POST",headers:{"Content-Type":"application/json",authorization:B||""},body:JSON.stringify({email:e,password:t,recaptchaToken:null==o?void 0:o.recaptchaToken,invisibleRecaptchaToken:null==o?void 0:o.invisibleRecaptchaToken})});return{member:s.member,token:null===(i=null==s?void 0:s.session)||void 0===i?void 0:i.token}},async handleOauthToken(e,t,o,i,a=!1){const r=n.getVisitorId();s.interactionStarted(C.SE.SOCIAL_APP_LOGIN),D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:t}});const{errorCode:l,payload:u}=await Te(ne,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({svSession:F,visitorId:r,token:e,provider:t,mode:o,lang:c.userLanguage,privacyStatus:i})});if(l)throw D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Failure",eventLabel:t}}),l;let g,d;s.interactionEnded(C.SE.SOCIAL_APP_LOGIN),u.smSession&&(d=u.smSession.siteMemberDto,g=u.smSession.sessionToken),d=u.siteMemberDto;const m=(0,f.Ky)(d),p=await Oe.handleLoginResponse({member:m,token:g},a);return D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:t}}),p},async handleSocialLoginResponse(e,t,o=!1){let i,a;s.interactionStarted(C.SE.SOCIAL_APP_LOGIN),s.interactionEnded(C.SE.SOCIAL_APP_LOGIN),D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:t}}),e.smSession&&(a=e.smSession.siteMemberDto,i=e.smSession.sessionToken),a=e.siteMemberDto;const n=(0,f.Ky)(a),r=await Oe.handleLoginResponse({member:n,token:i},o);return D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:t}}),r},async handleLoginResponse({token:e,member:t},o=!1){const i=t.emailVerified;if(e||i||"ACTIVE"!==t.status){if(e){const i=await Oe.applySessionToken(e,t,o);return Object.assign({sessionToken:e,member:t},o?{pages:i}:{})}return Oe.showAdminApprovalDialog(t.loginEmail,"login")}return Oe.showConfirmationEmailDialog(t.id)},async promptLogin(e,t,o){var i,s,a,n;void 0===e&&(e={}),void 0===t&&(t=null===(s=null===(i=Le.config)||void 0===i?void 0:i.isCloseable)||void 0===s||s),void 0===o&&(o=null!==(n=null===(a=Le.config)||void 0===a?void 0:a.returnPages)&&void 0!==n&&n);const{mode:r,modal:l}=e,c=null!=r?r:re,u=l?"popup":"fullscreen";if($){const e=await p();return await Oe.showNotificationDialog(e("siteMembersTranslations","siteMembersTranslations_TEMPLATE_NOTIFICATION_TITLE","Demo Mode"),e("siteMembersTranslations","siteMembersTranslations_TEMPLATE_NOTIFICATION_MESSAGE","To make this template yours, start editing it."),e("siteMembersTranslations","SMContainer_OK","OK")),Promise.reject(C.$9.CANCELED)}return"login"===c?Oe.showLoginDialog(t,u,o):Oe.showSignUpDialog(t,u,o)},promptForgotPassword:(e=!0)=>new Promise(((t,o)=>{Le.assignRequestAuthenticationPromise(t,o);const i={isCloseable:e,directionByLanguage:c.directionByLanguage},s={onCloseDialogCallback(){Ee.closingDialog("RequestResetPassword"),Ae.hideDialog(),Le.rejectAuthenticationRequest()},onSubmitCallback:e=>Oe.sendForgotPasswordMail(e).then((async()=>{const e=await p(),o=()=>{Le.resolveAuthenticationRequest(),t()};Oe.showNotificationDialog(e("siteMembersTranslations","siteMembersTranslations_RESET_PASSWORD_CHECKEMAIL_TITLE","Please Check Your Email"),e("siteMembersTranslations","siteMembersTranslations_RESET_PASSWORD_CHECKEMAIL_TEXT","We\u2019ve emailed you a link to reset your password."),e("siteMembersTranslations","siteMembersTranslations_Reset_Password_OK","Got It"),o,o)}))},a=E["specs.thunderbolt.smModalsShouldWaitForAppDidMount"]?ye():{};Ae.displayDialog("RequestPasswordResetDialog",i,s,a)})),async requestAuthentication(e={}){if(Se)return{success:!0,token:Se,reason:C.$9.ALREADY_LOGGED_IN};try{const t=!M,{sessionToken:o}=await Oe.promptLogin(e,t);return{success:!0,token:o,reason:C.$9.SUCCESS}}catch(e){return{success:!1,reason:e}}},async requestAuthorizedPages(e={}){if(be){return{success:!0,pages:await Oe.authorizeMemberPagesBySignedInstance(be)}}try{const t=!M;Le.setConfig({isCloseable:t,returnPages:!0});const o=await Oe.promptLogin(e,t,!0);return Le.reset(),{success:!0,pages:o.pages}}catch(e){return{success:!1,reason:e}}},async applySessionToken(e,t,o=!1){s.interactionStarted(C.SE.VERIFY_TOKEN);const{payload:i,errorCode:a}=await Te(oe,{method:"POST",body:`token=${e}`});if(a)throw a;if(s.interactionEnded(C.SE.VERIFY_TOKEN),await n.loadNewSession({reason:"memberLogin"}),be=n.getSmToken(),Se=e,we=null!=t?t:await Oe.getMemberDetails(),await Promise.all(Object.entries(Pe).map((async([e,t])=>{try{if("$$$timeout$$$"===await Promise.race([t(),(0,f._v)(3e3).then((()=>"$$$timeout$$$"))]))throw new Error(`callback ${e} timed out`)}catch(e){s.captureError(e,{tags:{feature:"site-members"}})}}))),o)return i.pages},async authorizeMemberPagesByCookie(){const e=(0,m.yF)(u)?{headers:{cookie:`smSession=${_}`}}:void 0,{authorizedPages:t,errorCode:o}=await Te(ie,e);if(o)throw o;return t},async authorizeMemberPagesByToken(e){if(e===_)return this.authorizeMemberPagesByCookie();const{payload:t,errorCode:o}=await Te(oe,{method:"POST",body:`token=${e}`});if(o)throw o;const{pages:i}=t;return i},async authorizeMemberPagesBySignedInstance(e){const t={headers:{authorization:e}},{authorizedPages:o,errorCode:i}=await Te(ie,t);if(i)throw i;return o},async getMemberDetails(e=!1){if(we.id&&!e)return we;if(be){const t=`/_api/wix-sm-webapp/member/${be}?collectionId=${O}&metaSiteId=${z}`,{payload:o,errorCode:i}=await Te(t);if(i)throw i;return we=(0,f.Ky)(o),e&&await Promise.all(Object.values(ke).map((async e=>{try{await e()}catch(e){s.captureError(e,{tags:{feature:"site-members"}})}}))),we}return null},async register(e,t,o,i,a,n,r,l){n=null!=n&&n;try{s.interactionStarted(C.SE.CODE_SIGNUP),D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Submit",eventLabel:"Wix"}});const c={email:e,password:t,profilePrivacyStatus:i,contactInfo:(0,f.t1)(o||{}),defaultFlow:a,recaptchaToken:r,invisibleRecaptchaToken:l},{member:u,session:g}=await Te("/_api/wix-sm-webapp/v1/auth/signup",{method:"POST",headers:{"Content-Type":"application/json",authorization:B||""},body:JSON.stringify(c)}),d=u.emailVerified,m=null==g?void 0:g.token,p="ACTIVE"===(null==u?void 0:u.status)?"ACTIVE":"PENDING";if(m||d||"ACTIVE"!==u.status){if(a&&"APPLICANT"===(null==u?void 0:u.status)||!m)return s.interactionEnded(C.SE.CODE_SIGNUP),Oe.showAdminApprovalDialog(e,"signup");{const e=await Oe.applySessionToken(m,u,n);return s.interactionEnded(C.SE.CODE_SIGNUP),D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Success",eventLabel:"Wix"}}),D.trackEvent({eventName:"CompleteRegistration",params:{origin:"Site members",method:"Wix"}}),Object.assign({member:u,status:p,sessionToken:m},n&&e?{pages:e}:{})}}return s.interactionEnded(C.SE.CODE_SIGNUP),Oe.showConfirmationEmailDialog(u.id)}catch(e){throw D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Failure",eventLabel:"Wix"}}),(0,f.fJ)(e)&&s.interactionEnded(C.SE.CODE_SIGNUP),e}},async sendForgotPasswordMail(e){s.interactionStarted(C.SE.RESET_PASSWORD);const t=c.userLanguage,o=encodeURIComponent(X),i=encodeURIComponent(e),{errorCode:a}=await Te("/_api/wix-sm-webapp/member/sendForgotPasswordMail",{method:"POST",body:`returnUrl=${o}&collectionId=${O}&metaSiteId=${z}&lang=${t}&email=${i}`});if(a)throw a;s.interactionEnded(C.SE.RESET_PASSWORD)},async sendSetPasswordEmail(e,t){const o=await Te("/_api/wix-sm-webapp/members/v1/auth/members/send-set-password-email",{method:"POST",headers:{"Content-Type":"application/json",authorization:B||""},body:JSON.stringify(Object.assign({email:e},(null==t?void 0:t.hideIgnoreMessage)?{hideIgnoreMessage:t.hideIgnoreMessage}:{}))});return!!(null==o?void 0:o.accepted)},async changePassword(e,t){const o=encodeURIComponent(e),{errorCode:i}=await Te(ae,{method:"POST",body:`newPassword=${o}&forgotPasswordToken=${t}`});if(i)throw i},async resendEmailVerification(e){const{errorCode:t}=await Te(`/_api/wix-sm-webapp/tokens/email/resend/${e}`);if(t)throw t},async logout(e){if(be){if(await Te(se,{method:"POST"}),await Promise.all(Object.values(fe).map((async e=>{try{await e()}catch(e){s.captureError(e,{tags:{feature:"site-members"}})}}))),e){const t=`./${e.replace(/^\//,"")}`;await g.navigate(t)}(0,m.yF)(u)||u.document.location.reload()}},registerToUserLogin:(e,t=(0,v.uniqueId)("callback"))=>(Pe[t]=e,t),unRegisterToUserLogin(e){delete Pe[e]},registerToMemberLogout(e){const t=(0,v.uniqueId)("logout_callback");return fe[t]=e,t},unRegisterToMemberLogout(e){delete fe[e]},registerToMemberDetailsRefresh(e){const t=(0,v.uniqueId)("mdrcb");return ke[t]=e,t},unRegisterToMemberDetailsRefresh(e){delete ke[e]},async showWelcomeDialog(e=!0){const t={isCloseable:e},o=h.getParsedUrl(),i={onCloseDialogCallback(){Ee.closingDialog("WelcomeDialog");const e=new URL(a.requestUrl).hostname,t=0===e.indexOf("www")?e.substr(3):e;I("sm_ef","/",t),j="",Ae.hideDialog(),g.navigate(o.href)},onSubmitCallback(){const e=new URL(a.requestUrl).hostname,t=0===e.indexOf("www")?e.substr(3):e;I("sm_ef","/",t),j="",Ae.hideDialog(),K&&g.navigate("./account/my-account"),g.navigate(o.href)}};Ae.displayDialog("WelcomeDialog",t,i)},async showNoPermissionsToPageDialog(e){const t={onCloseDialogCallback(){Ae.hideDialog(),e&&e()},onSwitchAccountLinkClick(){Oe.logout()}};Ae.displayDialog("NoPermissionsToPageDialog",{},t)},async showResetPasswordDialog(e){const t={isCloseable:!0,isTermsOfUseNeeded:!(!(null==ue?void 0:ue.enabled)||!V.termsOfUse),isPrivacyPolicyNeeded:!(!(null==ge?void 0:ge.enabled)||!V.privacyPolicy),termsOfUseLink:V.termsOfUse,privacyPolicyLink:V.privacyPolicy,directionByLanguage:c.directionByLanguage},o={onCloseDialogCallback(){Ee.closingDialog("ResetPasswordDialog");const e=h.getParsedUrl();e.searchParams.delete("forgotPasswordToken"),e.searchParams.delete("forgotPasswordLang"),h.pushUrlState(e),Ae.hideDialog(),g.navigate(e.href)},async onSubmitCallback(o){const i=await p();try{await Oe.changePassword(o,e),Oe.showNotificationDialog(i("siteMembersTranslations","siteMembersTranslations_Reset_Password_Sucess_Title","Your password has been changed."),"",i("siteMembersTranslations","SMContainer_OK","OK"),(async()=>{const e=h.getParsedUrl();e.searchParams.delete("forgotPasswordToken"),e.searchParams.delete("forgotPasswordLang"),h.pushUrlState(e),await Oe.showLoginDialog(),g.navigate(e.href)}))}catch(e){if(-19972!==e)throw e;Oe.showNotificationDialog(i("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_TITLE","Your link to create a new password has expired"),i("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_TEXT","To continue, resend a new link to your email."),i("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_OK","Resend Link"),(()=>Oe.promptForgotPassword(t.isCloseable).then((()=>{const e=h.getParsedUrl();g.navigate(e.href)}))))}}};Ae.displayDialog("ResetPasswordDialog",t,o,ye())},showLoginDialog:async(e=!0,t="fullscreen",o=!1)=>pe&&(null==S?void 0:S.isPopupPage(pe))?Oe.showCustomAuthenticationDialog(pe,o):new Promise((async(i,a)=>{Le.assignRequestAuthenticationPromise(i,a);const n={bsi:Re,displayMode:t,language:c.userLanguage,directionByLanguage:c.directionByLanguage,isCloseable:e,smCollectionId:O,svSession:F,biVisitorId:W(),metaSiteId:z,isSocialLoginGoogleEnabled:ce,isSocialLoginFacebookEnabled:!q&&le,isEmailLoginEnabled:!q,shouldForceCaptchaVerification:"Enabled"===E["specs.ShouldForceCaptchaVerificationOnLoginSpec"],isSocialAuthSupported:ee,shouldUseInvisibleCaptcha:E["specs.thunderbolt.useInvisibleCaptcha"]},r={onCloseDialogCallback(){Ae.hideDialog(),Ee.closingDialog("MemberLoginDialog",t),Le.rejectAuthenticationRequest()},submit:(e,a,n)=>(s.interactionStarted(C.SE.DEFAULT_LOGIN),Ee.emailAuthSubmitClicked("MemberLoginDialog",t),Oe.login(e,a,n,o).then((e=>{s.interactionEnded(C.SE.DEFAULT_LOGIN),Ae.hideDialog(),i(e)})).catch((e=>{throw(0,f.Y2)(e)&&s.interactionEnded(C.SE.DEFAULT_LOGIN),e}))),onForgetYourPasswordClick(){Oe.promptForgotPassword(e)},onSwitchDialogLinkClick(){Oe.showSignUpDialog(e,t,o).then(i,(()=>{Le.rejectAuthenticationRequest()}))},onTokenMessage(e,t,s=!1){let a;return N&&(a=s?"PUBLIC":"PRIVATE"),Oe.handleOauthToken(e,t,"memberLoginDialog",a,o).then((e=>{Ae.hideDialog(),i(e)}))},onBackendSocialLogin:(e,t)=>Oe.handleSocialLoginResponse(e,t,o).then((e=>{Ae.hideDialog(),i(e)})),getHostReadyPayload:()=>({visitorId:W(),svSession:F})};Ee.loginOrSignUpDialogLoaded("MemberLoginDialog",t),await Ae.displayDialog("MemberLoginDialog",n,r,ye()),Oe.closeCustomAuthenticationDialogs(!0)})),showSignUpDialog:async(e=!0,t="fullscreen",o=!1)=>me&&(null==S?void 0:S.isPopupPage(me))?Oe.showCustomAuthenticationDialog(me,o):new Promise((async(i,a)=>{Le.assignRequestAuthenticationPromise(i,a);const n={bsi:Re,displayMode:t,language:c.userLanguage,directionByLanguage:c.directionByLanguage,isCloseable:e,smCollectionId:O,biVisitorId:W(),svSession:F,metaSiteId:z,isSocialLoginGoogleEnabled:ce,isSocialLoginFacebookEnabled:!q&&le,isSocialAuthSupported:ee,isEmailLoginEnabled:!q,isCommunityInstalled:N,joinCommunityCheckedByDefault:he,isTermsOfUseNeeded:!(!(null==ue?void 0:ue.enabled)||!V.termsOfUse),isPrivacyPolicyNeeded:!(!(null==ge?void 0:ge.enabled)||!V.privacyPolicy),isCodeOfConductNeeded:!(!(null==de?void 0:de.enabled)||!V.codeOfConduct),shouldUseInvisibleCaptcha:E["specs.thunderbolt.useInvisibleCaptcha"],shouldForceCaptchaVerification:"Enabled"===E["specs.ShouldForceCaptchaVerificationOnSignupSpec"],termsOfUseLink:V.termsOfUse,privacyPolicyLink:V.privacyPolicy,codeOfConductLink:V.codeOfConduct},r={onCloseDialogCallback(){Ae.hideDialog(),Ee.closingDialog("SignUpDialog",t),Le.rejectAuthenticationRequest()},submit(e,a,n){let r;if(N){r=("boolean"==typeof n?n:n.isCommunityChecked)?C.iY.PUBLIC:C.iY.PRIVATE}const l="boolean"==typeof n||null==n?void 0:n.recaptchaToken,c="boolean"==typeof n||null==n?void 0:n.invisibleRecaptchaToken;return s.interactionStarted(C.SE.DEFAULT_SIGNUP),Ee.emailAuthSubmitClicked("SignUpDialog",t),Oe.register(e,a,void 0,r,void 0,o,l,c).then((e=>{s.interactionEnded(C.SE.DEFAULT_SIGNUP);const{member:t,sessionToken:a,pages:n}=e;a&&(Ae.hideDialog(),i(Object.assign({member:t,sessionToken:a},o?{pages:n}:{})))})).catch((e=>{throw(0,f.fJ)(e)&&s.interactionEnded(C.SE.DEFAULT_SIGNUP),e}))},onSwitchDialogLinkClick(){Oe.showLoginDialog(e,t,o).then(i,(()=>{Le.rejectAuthenticationRequest()}))},onTokenMessage(e,t,s=!1){let a;return N&&(a=s?"PUBLIC":"PRIVATE"),Oe.handleOauthToken(e,t,"memberLoginDialog",a,o).then((e=>{Ae.hideDialog(),i(e)}))},onBackendSocialLogin:(e,t)=>Oe.handleSocialLoginResponse(e,t,o).then((e=>{Ae.hideDialog(),i(e)})),getHostReadyPayload:()=>({visitorId:W(),svSession:F})};Ee.loginOrSignUpDialogLoaded("SignUpDialog",t),await Ae.displayDialog("SignUpDialog",n,r,ye()),Oe.closeCustomAuthenticationDialogs(!0)})),async hideAuthDialog(){console.warn("hideAuthDialog is not supported")},async showNotificationDialog(e,t,o,i=(()=>0),s=(()=>0)){const a={isCloseable:!0,title:e,description:t,okButtonText:o},n={onCloseDialogCallback(){Ee.closingDialog("NotificationDialog"),Ae.hideDialog(),s()},onOkButtonClick(){Ae.hideDialog(),i()}};await Ae.displayDialog("NotificationDialog",a,n)},async showConfirmationEmailDialog(e,t=!0){if(E["specs.thunderbolt.rejectApprovalNeededAuthenticationRequests"])return new Promise(((o,i)=>{const s={isCloseable:!0,isSignUp:t},a={onCloseDialogCallback(){Ee.closingDialog("ConfirmationEmailDialog"),Ae.hideDialog(),Le.rejectAuthenticationRequest(),i(C.$9.CANCELED)},async onResendConfirmationEmail(){await Oe.resendEmailVerification(e),await Oe.showConfirmationEmailDialog(e,!1).catch(i)}};Ae.displayDialog("ConfirmationEmailDialog",s,a)}));{const o={isCloseable:!0,isSignUp:t},i={onCloseDialogCallback(){Ee.closingDialog("ConfirmationEmailDialog"),Ae.hideDialog()},async onResendConfirmationEmail(){await Oe.resendEmailVerification(e),await Oe.showConfirmationEmailDialog(e,!1)}};return Ae.displayDialog("ConfirmationEmailDialog",o,i).then(f.Y_)}},async showAdminApprovalDialog(e,t){const o=await p();return E["specs.thunderbolt.rejectApprovalNeededAuthenticationRequests"]?new Promise(((i,s)=>{const a=()=>{Le.rejectAuthenticationRequest(),s(C.$9.CANCELED)};Oe.showNotificationDialog("",`${o("siteMembersTranslations","SMApply_Success1",`Success! Your member ${t} request has been sent and is awaiting approval.`)} ${o("siteMembersTranslations","SMApply_Success2","The site administrator will notify you via email ({0}) once your request has been approved.")}`.replace("{0}",e),o("siteMembersTranslations","SMContainer_OK","OK"),a,a)})):Oe.showNotificationDialog("",`${o("siteMembersTranslations","SMApply_Success1",`Success! Your member ${t} request has been sent and is awaiting approval.`)} ${o("siteMembersTranslations","SMApply_Success2","The site administrator will notify you via email ({0}) once your request has been approved.")}`.replace("{0}",e),o("siteMembersTranslations","SMContainer_OK","OK")).then(f.Y_)},async showCustomAuthenticationDialog(e,t=!1){if(!S)throw new Error("popup unavailable");return new Promise((async(o,i)=>{Le.assignRequestAuthenticationPromise(o,i);const s=Oe.registerToUserLogin((async()=>{Le.requestAuthenticationResolveInstance(Object.assign({member:we,sessionToken:Se},t?{pages:await Oe.authorizeMemberPagesBySignedInstance(be)}:{})),Oe.unRegisterToUserLogin(s),S.getCurrentPopupId()===e&&S.closePopupPage()}),"customAuthCbId");await Le.openPopupPage(e,(()=>{Oe.unRegisterToUserLogin(s)})),Ae.hideDialog()}))},async closeCustomAuthenticationDialogs(e=!1){const t=null==S?void 0:S.getCurrentPopupId();t&&[me,pe].includes(t)&&(e&&Le.preventCustomPopupCloseCallback(),await S.closePopupPage(),Le.allowCustomPopupCloseCallback())},getForgotPasswordToken:()=>new URL((0,m.yF)(u)?a.requestUrl:location.href).searchParams.get("forgotPasswordToken"),shouldDisplayWelcomeDialog:()=>j&&K,appWillMount(){switch(new URL(a.requestUrl).searchParams.get("showDialog")){case"MemberLoginDialog":Oe.showLoginDialog();break;case"SignUpDialog":Oe.showSignUpDialog();break;case"RequestPasswordResetDialog":Oe.promptForgotPassword();break;case"ResetPasswordDialog":Oe.showResetPasswordDialog("faketoken");break;case"WelcomeDialog":Oe.showWelcomeDialog();break;case"NoPermissionsToPageDialog":Oe.showNoPermissionsToPageDialog();break;case"NotificationDialog":Oe.showNotificationDialog("title","description","ok");break;case"ConfirmationEmailDialog":Oe.showConfirmationEmailDialog("fakemember")}},pageWillUnmount({pageId:e}){[me,pe].includes(e)||Ae.hideDialog()},getSocialAuthComponentProps:()=>(0,f.IO)({config:e,viewerModel:a,sessionManager:n,bsiManager:T,handleOauthToken:Oe.handleOauthToken,handleSocialLoginResponse:Oe.handleSocialLoginResponse,isSocialAuthSupported:te})};return o.update((()=>({shouldShowRenderingBlockingDialogs:()=>!(!Oe.getForgotPasswordToken()&&!Oe.shouldDisplayWelcomeDialog()),showRenderingBlockingDialogs:()=>{const e=Oe.getForgotPasswordToken();return e?Oe.showResetPasswordDialog(e):Oe.shouldDisplayWelcomeDialog()?Oe.showWelcomeDialog():void 0}}))),Oe}));var O=o(13487),_=o(46450),M=o(11986);const N=(0,i.ff)([y.n9],(e=>({getTpaHandlers(){const t=async(t,o,i)=>{var s,a,n;const r=await e.getMemberDetails();return r?(null===(s=i.appClientSpecMapData)||void 0===s?void 0:s.isWixTPA)?{attributes:{firstName:null!==(a=r.firstName)&&void 0!==a?a:"",lastName:null!==(n=r.lastName)&&void 0!==n?n:"",privacyStatus:r.profilePrivacyStatus},name:r.memberName,email:r.loginEmail,id:r.id,owner:r.owner,status:r.status}:{id:r.id,owner:r.owner,status:r.status}:null},o=async(t,o={})=>{var i,s;const{member:a}=await e.promptLogin({mode:o.mode,modal:o.modal});return{attributes:{firstName:null!==(i=a.firstName)&&void 0!==i?i:"",lastName:null!==(s=a.lastName)&&void 0!==s?s:"",privacyStatus:a.profilePrivacyStatus},name:a.memberName,email:a.loginEmail,id:a.id,owner:a.owner,status:a.status}};return{currentMember:t,smCurrentMember:t,logOutCurrentMember:(0,M.u)(["site"],((t,o)=>{e.logout(null==o?void 0:o.url)})),requestLogin:(0,M.u)(["site"],o),smRequestLogin:(0,M.u)(["site"],o)}}}))),U=(0,i.ff)([y.n9,(0,i.t6)(s.$e,y.u2),r.xP],((e,{componentIds:t},o)=>({name:"site-members-components",async pageWillMount(){const i=t.reduce(((t,o)=>{const i=e.getSocialAuthComponentProps();return Object.assign(Object.assign({},t),{[o]:i})}),{});o.update(i)}}))),$=(0,i.ff)([(0,i.t6)(s.Wf,y.u2)],(e=>({handle:async t=>{const{shouldShowRenderingBlockingDialogs:o,showRenderingBlockingDialogs:i}=e.get();return o()?(i(),null):t}}))),j=e=>{e(y.n9,O.j.AppWillMountHandler,O.j.AppDidMountHandler).to(R),e(h.BD.BlockingDialogs).to($)},q=e=>{e(_.go).to(N),e(O.j.PageWillMountHandler).to(U),e(O.j.PageWillUnmountHandler).to((0,i.ff)([y.n9],(e=>({pageWillUnmount:t=>e.pageWillUnmount(t)}))))}}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/siteMembers.b736f610.chunk.min.js.map